### **第 6 章 掃描線與分治法**

---

#### **6.1 掃描線技術的基本概念**

掃描線技術是一種利用一條假想的線（通常水平或垂直）逐步掃描整個幾何平面，動態處理幾何結構的演算法思想。

- **基本思想**  
  - 掃描線自一端移動至另一端，逐步處理與掃描線交互的幾何對象（如線段、頂點、區域等）。  
  - 使用動態數據結構記錄當前與掃描線相關的幾何信息，隨著掃描線的移動實時更新。

- **主要特點**  
  1. **事件驅動**  
     - 按事件點（例如多邊形頂點、線段端點）排序並依次處理，避免全局遍歷。  
  2. **動態更新**  
     - 利用動態數據結構（如平衡樹）存儲掃描線的有效幾何對象並進行快速查詢與更新。  

- **典型應用**  
  1. 計算多邊形的併合與交集。  
  2. 判斷線段是否相交。  
  3. 處理可視化中的遮擋關係。  

---

#### **6.2 多邊形併合（Polygon Union）**

多邊形併合是將多個多邊形合併成其幾何上的聯集區域，常用於地理信息系統和圖形處理。

- **問題描述**  
  - 給定多個多邊形，計算其聯集區域並生成新的多邊形表示。  

- **掃描線解法**  
  1. **事件點分類**  
     - 每個多邊形的頂點根據掃描線的方向分為進入點和退出點。  
  2. **動態邊表（Active Edge Table, AET）**  
     - 隨掃描線移動，記錄當前與掃描線相交的多邊形邊。  
  3. **事件處理**  
     - 當掃描線遇到事件點時，更新 AET 並判斷相交區域的幾何屬性。  
  4. **生成結果**  
     - 將掃描過程中計算的邊界信息重建為新的多邊形。

- **時間複雜度**  
  - 假設點數為 \( n \)，邊數為 \( m \)，掃描線法的時間複雜度為 \( O((n + m) \log n) \)。

- **應用案例**  
  - 地圖中區域合併處理。  
  - 圖像分割與合成。  

---

#### **6.3 使用分治法解決最近點對與其他幾何問題**

分治法是解決幾何問題的重要工具，通過遞歸將問題劃分為小問題並合併結果。

---

##### **6.3.1 最近點對問題**

- **問題描述**  
  - 給定平面上 \( n \) 個點，找到距離最近的兩點。

- **分治演算法**  
  1. **分割點集**  
     - 按點的 x 坐標排序並將點集劃分為左右兩部分。  
  2. **遞歸求解**  
     - 分別計算左右兩部分的最近點對，記為 \( \delta_L \) 和 \( \delta_R \)。  
  3. **合併結果**  
     - 計算跨越分界線的最近點對：  
       - 在分界線兩側寬度為 \( \delta = \min(\delta_L, \delta_R) \) 的帶狀區域內，僅需比較帶內點之間的距離。  
       - 利用 y 坐標排序，將比較數量限制為常數級。  
  4. **返回結果**  
     - 最終最近距離為 \( \delta \)。  

- **時間複雜度**  
  - 排序 \( O(n \log n) \)，帶狀區域檢查 \( O(n) \)，總計 \( O(n \log n) \)。

---

##### **6.3.2 其他幾何問題的分治解法**

1. **凸包問題**  
   - 使用分治法計算左右子點集的凸包，然後合併。  
   - 合併步驟中需處理兩凸包的上、下公切線。  
   - 時間複雜度 \( O(n \log n) \)。

2. **多邊形相交測試**  
   - 分治法應用於多邊形頂點分組，遞歸檢查左右多邊形的相交情況，合併時處理跨越分界的相交邊。  
   - 適合處理大量多邊形的情況。

3. **線段相交問題**  
   - 將線段按端點 x 坐標排序，分組後遞歸判斷子問題中線段相交情況，合併時處理跨分界的相交。  
   - 利用掃描線與分治結合實現高效檢測。

---

#### **章節總結**  
本章闡述了掃描線和分治法的基本概念與應用，詳細分析了多邊形併合、最近點對等經典問題的解法，並探討了兩種技術的結合使用，為處理複雜幾何問題提供了高效的工具與方法。