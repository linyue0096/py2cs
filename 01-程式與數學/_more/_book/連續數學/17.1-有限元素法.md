### **17.1 有限元素法（Finite Element Method, FEM）**

有限元素法（FEM）是一種數值技術，廣泛應用於解決物理和工程中各類偏微分方程的問題，特別是在結構力學、熱傳導、流體動力學等領域。FEM的基本思想是將一個複雜的連續問題分解為多個較小、簡單的子問題，然後用數值方法來求解這些子問題的近似解。

#### **17.1.1 FEM的基本原理**

有限元素法的核心是將求解的區域（通常是空間中的一個物理結構或領域）分割成許多小的、互相連接的子區域，稱為“元素”（elements）。這些元素可以是線性、一維的（如一根桿）、二維的（如三角形或矩形）、或者三維的（如四面體或立方體）。每個元素的解（如位移、溫度等物理量）由一組基函數進行逼近，通常稱為“形狀函數”（shape functions）。

簡單來說，有限元素法將連續問題轉化為離散問題。通過在每個元素上選擇適當的基函數，將整個領域的解轉換為一組代數方程，最終通過數值方法求解這些方程，得到問題的近似解。

#### **17.1.2 FEM的步驟**

1. **網格劃分（Meshing）**：
   將求解區域劃分為小的子區域（元素），這一過程稱為網格劃分。網格的質量和結構對最終結果有重大影響，通常需要平衡計算精度與計算資源。

2. **選擇形狀函數（Shape Functions）**：
   每個元素需要選擇一組形狀函數來描述元素內部的變量分佈。這些形狀函數通常是多項式函數，並且在每個元素的節點處有固定的值。

3. **建立局部方程（Element Equations）**：
   根據問題的物理模型（如熱傳導、結構力學等），寫出每個元素的局部方程。這些方程通常是基於問題的弱形式（弱解）推導出來的。

4. **組合全局方程（Assembly of Global Equations）**：
   將所有元素的局部方程組合成一個全局方程，這些方程描述了整個問題的行為。這一步需要處理元素之間的邊界條件和相互作用。

5. **施加邊界條件（Boundary Conditions）**：
   邊界條件是物理問題的核心部分，通常需要在全局方程中施加適當的邊界條件（例如，位移為零、固定溫度等）。

6. **求解代數方程（Solving the System of Equations）**：
   得到全局方程後，通常會形成一個大型的線性代數方程組。使用數值方法（如高斯消去法、共軛梯度法等）求解這些方程。

7. **後處理（Post-Processing）**：
   計算結果得到後，進行後處理以分析結果，這可能包括圖形化顯示變量的分佈、計算內力、應力場等。

#### **17.1.3 FEM的應用領域**

- **結構分析**：
  在土木工程、機械工程等領域，有限元素法用於分析結構的變形、應力、應變等。這可以包括梁、板、膜等結構的靜態和動態分析。

- **熱傳導分析**：
  在熱工程中，FEM被用來求解熱傳導方程，預測物體在不同時間和空間點的溫度分佈。

- **流體動力學**：
  對於流體問題，尤其是不可壓縮流體的模擬，有限元素法可以解決Navier-Stokes方程，並用於模擬流體的流動、熱交換等問題。

- **電磁場分析**：
  在電氣工程中，FEM也被用於求解Maxwell方程，進行電磁場的模擬和分析。

- **地質與地震工程**：
  FEM被用於模擬地下結構、岩土工程問題和地震波的傳播。

#### **17.1.4 FEM的優缺點**

- **優點**：
  - **適應性強**：FEM可以處理非常複雜的幾何形狀和邊界條件，適用於各種實際工程問題。
  - **精度高**：通過細化網格，可以提高計算的精度。
  - **靈活性強**：可以適用於不同物理領域（如結構、熱、流體、電磁等）的多種問題。

- **缺點**：
  - **計算成本高**：對於大規模問題，有限元素法可能需要大量的計算資源和時間。
  - **網格劃分的挑戰**：在複雜幾何形狀下，網格的劃分可能會變得非常困難，且高質量的網格需要更多的計算資源。
  - **求解器效率**：對於非常大的系統，求解代數方程組可能需要高效的數值方法，這可能會成為性能瓶頸。

#### **17.1.5 例子：結構分析中的FEM**

假設我們有一個簡單的梁，想要分析其在外力作用下的位移和應力分佈。我們首先將梁劃分為許多小元素，每個元素都可以用一組形狀函數來描述其內部的位移。在施加了適當的邊界條件（如梁兩端的固定或支撐）後，通過有限元素法計算得到的結果將顯示出梁在外力作用下的變形情況。

1. **網格劃分**：將梁劃分為若干小元素。
2. **形狀函數選擇**：選擇合適的形狀函數來逼近每個元素的位移場。
3. **局部方程的建立**：基於平衡方程、應力-應變關係，為每個元素建立局部方程。
4. **全局方程的組合與邊界條件的施加**：將局部方程組合成全局方程並施加邊界條件。
5. **求解與後處理**：求解得到位移場，並計算應力分佈。

通過這一過程，有限元素法幫助我們得到了梁在各種工況下的變形與應力情況。

#### **結論**

有限元素法是數值分析中強大而靈活的工具，廣泛應用於解決實際的物理問題。通過將大問題分解為小問題，FEM能夠處理複雜的幾何形狀、邊界條件和材料性質，並提供精確的數值解。儘管存在一定的計算挑戰，隨著計算能力和數值方法的發展，有限元素法已成為工程分析中不可或缺的工具。