以下是 **3.2 隨機變數與分布：高斯分布與多元分布** 內容提綱，介紹隨機變數的基本概念，以及常見的高斯分布和多元高斯分布在機器學習中的應用。

---

## **3.2 隨機變數與分布：高斯分布與多元分布**

---

### **3.2.1 隨機變數與其分布**
- **隨機變數的定義**：
  - 隨機變數是對隨機實驗結果的數值化表示，通常用  $X$ 、 $Y$ 、 $Z$  等字母表示。隨機變數分為**離散隨機變數**和**連續隨機變數**：
    - **離散隨機變數**：取離散值，如擲骰子的結果。
    - **連續隨機變數**：取連續值，如身高、體重等。

- **機率分布**：
  - 機率分布描述隨機變數取各個值的概率。對於離散隨機變數，有**概率質量函數（PMF）**；對於連續隨機變數，有**概率密度函數（PDF）**。

---

### **3.2.2 高斯分布（正態分布）**
- **高斯分布的定義**：
  - 高斯分布，也稱為正態分布，是最常見的連續隨機變數的分布之一，其概率密度函數（PDF）表達式為：

```math
    f(x) = \frac{1}{\sqrt{2\pi \sigma^2}} \exp\left(-\frac{(x - \mu)^2}{2\sigma^2}\right)

```
    其中， $\mu$  是均值， $\sigma$  是標準差，描述分布的中心位置和散布程度。

- **高斯分布的特徵**：
  - **對稱性**：高斯分布是一個對稱的鐘形曲線，其均值  $\mu$  是分布的對稱中心。
  - **68-95-99.7 法則**：在標準正態分布中，68%的數據位於均值的1個標準差範圍內，95%位於2個標準差內，99.7%位於3個標準差內。
  - 高斯分布在自然界和各種應用中非常常見，許多隨機現象（如測量誤差、身高、血壓等）都遵循高斯分布。

- **標準正態分布**：
  - 當  $\mu = 0$  且  $\sigma = 1$  時，稱為標準正態分布，其概率密度函數簡化為：

```math
    f(x) = \frac{1}{\sqrt{2\pi}} \exp\left(-\frac{x^2}{2}\right)

```

- **高斯分布在機器學習中的應用**：
  - **生成模型**：許多生成模型（如高斯混合模型）基於高斯分布生成數據。
  - **回歸分析**：在回歸分析中，假設誤差服從高斯分布是一個常見假設。
  - **高斯過程**：高斯過程是非參數的貝葉斯方法，用於回歸和分類。

- **例子**：
  假設一個測量系統的誤差服從正態分布，均值為 0，標準差為 1，則測量結果的分布會呈現鐘形曲線，最常見的誤差範圍是在均值附近。

---

### **3.2.3 多元高斯分布**
- **多元高斯分布的定義**：
  - 多元高斯分布（或稱為多變量正態分布）是高維隨機變數的分布，其概率密度函數（PDF）表示為：

```math
    f(\mathbf{x}) = \frac{1}{(2\pi)^{d/2} |\Sigma|^{1/2}} \exp\left(-\frac{1}{2} (\mathbf{x} - \mu)^T \Sigma^{-1} (\mathbf{x} - \mu)\right)

```
    其中， $\mathbf{x} \in \mathbb{R}^d$  是  $d$ -維隨機向量， $\mu$  是均值向量， $\Sigma$  是協方差矩陣。

- **多元高斯分布的特徵**：
  - **均值向量  $\mu$ **：表示各維度隨機變數的均值。
  - **協方差矩陣  $\Sigma$ **：描述各維度隨機變數之間的相關性。對角線上的元素是各維度的方差，非對角線元素是各維度之間的協方差。

- **多元高斯分布的應用**：
  - **主成分分析（PCA）**：PCA 方法可以用來找出數據中的主要方向，並且這些方向上的數據往往服從高斯分布。
  - **高斯混合模型（GMM）**：高斯混合模型是一種常見的聚類算法，其假設數據由多個高斯分布組成。
  - **模式識別與分類**：多元高斯分布在模式識別和圖像分類中有廣泛應用，尤其是在高斯朴素貝葉斯分類器中。

- **例子**：
  假設有一個二維數據集，其中一個維度表示人的身高，另一個維度表示體重。假設這些數據服從一個二維高斯分布，則可以用均值向量和協方差矩陣來描述這些數據的分布情況。

---

### **3.2.4 高斯分布與多元分布在 LLM 中的應用**
- **語言模型中的高斯分布應用**：
  - 在自然語言處理中，許多技術（如詞向量）會假設某些隨機變數服從高斯分布。例如，Word2Vec 中的負樣本采樣方法會假設單詞在某些向量空間中服從正態分布。
  
- **高斯分布在生成模型中的應用**：
  - 在生成對抗網絡（GAN）和變分自編碼器（VAE）等模型中，生成模型的輸出通常是高斯分布，並且可以通過訓練來學習這些分布的參數。

- **多元高斯分布在語言生成中的應用**：
  - 在多任務學習中，使用多元高斯分布來描述多個輸出變數的相關性，有助於改進多任務模型的表現。

---

### **3.2.5 Python 實作：高斯分布與多元分布**
- **生成高斯分布數據**：
  使用 `numpy` 庫來生成正態分布數據：
  ```python
  import numpy as np
  mu = 0  # 均值
  sigma = 1  # 標準差
  data = np.random.normal(mu, sigma, 1000)  # 生成 1000 個樣本
  ```

- **繪製高斯分布曲線**：
  ```python
  import matplotlib.pyplot as plt
  import seaborn as sns
  
  sns.histplot(data, kde=True, stat="density", bins=30)
  plt.title('Normal Distribution')
  plt.show()
  ```

- **多元高斯分布的生成**：
  使用 `numpy` 生成二維高斯分布數據：
  ```python
  mu = [0, 0]  # 二維均值向量
  sigma = [[1, 0.8], [0.8, 1]]  # 協方差矩陣
  data = np.random.multivariate_normal(mu, sigma, 500)
  ```

- **繪製多元高斯分布數據**：
  ```python
  plt.scatter(data[:, 0], data[:, 1], alpha=0.6)
  plt.title('Multivariate Normal Distribution')
  plt.show()
  ```

---

### **3.2.6 小結**
- 高斯分布和多元高斯分布在數據科學、機器學習和語言模型中有廣泛的應用，並且在處理隨機變數、建立生成模型、